Most of the code is dervied from MSDN community and winAPI programming reference.
